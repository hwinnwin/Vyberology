import{j as e}from"./ui-vendor-BdNHRkPp.js";import{r as o,u as y}from"./react-vendor-BrWXyIWg.js";import{C as v,B as N,L as w,b as D,d as C,e as k,f as P,A as S,H as E,g as R,h as j}from"./index-BU0JQuHZ.js";import{I as p}from"./input-BUOmuTmR.js";import{L as g,R as B,E as F}from"./error-message-Bjh22J7Y.js";import{s as $}from"./alert-DNlM_nKM.js";import{s as A}from"./readingHistory-CkV6lPJ-.js";import"./supabase-vendor-k7UXo7He.js";import"./query-vendor-aFyS-rxT.js";import"./copy-CjauooGe.js";function L({onGenerate:x,isLoading:s}){const[i,d]=o.useState(""),[n,c]=o.useState(""),[r,h]=o.useState(""),[m,u]=o.useState(""),[a,b]=o.useState({}),f=t=>{t.preventDefault();const l={};if((!i.trim()||i.trim().length<2)&&(l.aName="Please enter a real name for Person A"),(!n||!/^\d{4}-\d{2}-\d{2}$/.test(n))&&(l.aDob="Please enter a valid date (YYYY-MM-DD)"),(!r.trim()||r.trim().length<2)&&(l.bName="Please enter a real name for Person B"),(!m||!/^\d{4}-\d{2}-\d{2}$/.test(m))&&(l.bDob="Please enter a valid date (YYYY-MM-DD)"),Object.keys(l).length>0){b(l);return}b({}),x(i,n,r,m)};return e.jsxs(v,{className:"border-white/10 bg-lf-ink/60 p-6 backdrop-blur",children:[e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 p-4 rounded-lg bg-lf-midnight/30 border border-lf-violet/20",children:[e.jsx("h3",{className:"font-semibold text-sm text-lf-aurora",children:"Person A"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"aName",className:"text-white",children:"Full Name"}),e.jsx(p,{id:"aName",type:"text",placeholder:"e.g., Huynh Duc Tung Nguyen",value:i,onChange:t=>d(t.target.value),className:`border-lf-violet/30 bg-lf-midnight/50 text-white placeholder:text-lf-slate ${a.aName?"border-red-500":""}`}),a.aName&&e.jsx("p",{className:"text-sm text-red-400",children:a.aName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"aDob",className:"text-white",children:"Date of Birth"}),e.jsx(p,{id:"aDob",type:"date",value:n,onChange:t=>c(t.target.value),className:`border-lf-violet/30 bg-lf-midnight/50 text-white ${a.aDob?"border-red-500":""}`}),a.aDob&&e.jsx("p",{className:"text-sm text-red-400",children:a.aDob})]})]}),e.jsxs("div",{className:"space-y-4 p-4 rounded-lg bg-lf-midnight/30 border border-lf-violet/20",children:[e.jsx("h3",{className:"font-semibold text-sm text-lf-aurora",children:"Person B"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"bName",className:"text-white",children:"Full Name"}),e.jsx(p,{id:"bName",type:"text",placeholder:"e.g., Sarah Martinez",value:r,onChange:t=>h(t.target.value),className:`border-lf-violet/30 bg-lf-midnight/50 text-white placeholder:text-lf-slate ${a.bName?"border-red-500":""}`}),a.bName&&e.jsx("p",{className:"text-sm text-red-400",children:a.bName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"bDob",className:"text-white",children:"Date of Birth"}),e.jsx(p,{id:"bDob",type:"date",value:m,onChange:t=>u(t.target.value),className:`border-lf-violet/30 bg-lf-midnight/50 text-white ${a.bDob?"border-red-500":""}`}),a.bDob&&e.jsx("p",{className:"text-sm text-red-400",children:a.bDob})]})]}),e.jsxs(N,{type:"submit",className:"w-full bg-lf-gradient hover:shadow-glow",disabled:s,children:[s&&e.jsx(w,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Generating Compatibility...":"Generate Compatibility Reading"]})]}),!i&&!n&&!r&&!m&&e.jsx("p",{className:"text-sm text-lf-slate text-center mt-4",children:"Enter both names and dates of birth to discover your compatibility & synergy."})]})}const Y=o.memo(function({reading:s}){var i,d,n,c;return e.jsxs(v,{className:"overflow-hidden",children:[e.jsxs(D,{children:[e.jsx(C,{children:"Compatibility Reading"}),e.jsxs(k,{children:[s.left.fullName," × ",s.right.fullName]})]}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3 p-4 rounded-lg bg-muted/50",children:[e.jsx("h3",{className:"font-semibold text-sm",children:s.left.fullName}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"text-center p-2 rounded bg-background",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:s.left.numbers.lifePath.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"LP"})]}),e.jsxs("div",{className:"text-center p-2 rounded bg-background",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:s.left.numbers.expression.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Expr"})]}),e.jsxs("div",{className:"text-center p-2 rounded bg-background",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:s.left.numbers.soulUrge.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Soul"})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Dominant: ",((i=s.left.chakras[0])==null?void 0:i.dominant)??"—"," • Bridge:"," ",((d=s.left.chakras[0])==null?void 0:d.bridge)??"—"]})]}),e.jsxs("div",{className:"space-y-3 p-4 rounded-lg bg-muted/50",children:[e.jsx("h3",{className:"font-semibold text-sm",children:s.right.fullName}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"text-center p-2 rounded bg-background",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:s.right.numbers.lifePath.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"LP"})]}),e.jsxs("div",{className:"text-center p-2 rounded bg-background",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:s.right.numbers.expression.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Expr"})]}),e.jsxs("div",{className:"text-center p-2 rounded bg-background",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:s.right.numbers.soulUrge.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Soul"})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Dominant: ",((n=s.right.chakras[0])==null?void 0:n.dominant)??"—"," • Bridge:"," ",((c=s.right.chakras[0])==null?void 0:c.bridge)??"—"]})]})]}),e.jsxs("div",{className:"space-y-3 p-4 rounded-lg bg-primary/5 border border-primary/10",children:[e.jsx("h3",{className:"text-sm font-semibold text-primary",children:"Synergy Highlights"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Life Path:"})," ",s.synergy.lifePathBlend.code]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Expression:"})," ",s.synergy.expressionBlend.code]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Chakra Weave:"})," ",s.synergy.chakraWeave.dominant??"—"]})]})]}),e.jsxs("div",{className:"space-y-4 p-6 rounded-lg bg-primary/5 border border-primary/10",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Action Plan"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("h4",{className:"font-semibold text-sm mb-2",children:["Focus: ",s.actions.focus]})}),e.jsx("div",{className:"space-y-3",children:s.actions.actions.map((r,h)=>e.jsxs("div",{className:"flex gap-3 items-start",children:[e.jsxs("span",{className:"font-semibold text-primary text-sm min-w-[100px]",children:[r.chakra,":"]}),e.jsx("span",{className:"text-sm flex-1",children:r.text})]},h))}),e.jsxs("p",{className:"italic text-center text-sm mt-4 pt-4 border-t border-primary/20",children:['"',s.actions.mantra,'"']})]})]}),e.jsxs("div",{className:"space-y-2 p-6 rounded-lg bg-muted/50 border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Complete Reading"}),e.jsx("pre",{className:"whitespace-pre-wrap text-sm leading-relaxed font-sans",children:s.narrative})]}),e.jsx(B,{readingText:s.narrative,title:`Compatibility Reading - ${s.left.fullName} × ${s.right.fullName}`})]})]})});function V(){const x=y(),[s,i]=o.useState(null),[d,n]=o.useState(!1),[c,r]=o.useState(null),h=async(u,a,b,f)=>{n(!0),r(null),i(null);try{const{data:t,error:l}=await $.functions.invoke("compare",{body:{aName:u,aDob:a,bName:b,bDob:f}});if(l)throw new Error(l.message||"Failed to generate compatibility reading");if(!t)throw new Error("No data received from server");i(t),A({inputType:"manual",inputValue:`${u} & ${b}`,reading:JSON.stringify(t)}),j({title:"Success!",description:"Your compatibility reading has been generated."})}catch(t){console.error("Error generating compatibility reading:",t);const l=t instanceof Error?t.message:"An unexpected error occurred";r(l),j({title:"Error",description:l,variant:"destructive"})}finally{n(!1)}},m=()=>{r(null)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-lf-midnight via-lf-ink to-lf-midnight",children:e.jsxs("div",{className:"container max-w-4xl py-12 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs(N,{onClick:()=>x(-1),variant:"ghost",className:"gap-2 text-white hover:text-lf-aurora",children:[e.jsx(S,{className:"h-5 w-5"}),"Back"]}),e.jsxs(N,{onClick:()=>x("/"),variant:"ghost",className:"gap-2 text-white hover:text-lf-aurora",children:[e.jsx(E,{className:"h-5 w-5"}),"Home"]})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight text-white",children:"Compatibility Reading"}),e.jsx("p",{className:"text-lf-slate",children:"Discover how two numerology profiles interact and complement each other"})]}),e.jsx(L,{onGenerate:h,isLoading:d}),d&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(R,{size:"lg",text:"Calculating compatibility... This may take a moment."})}),c&&!d&&e.jsx(F,{title:"Failed to Generate Compatibility Reading",message:c,onRetry:m}),s&&!d&&!c&&e.jsx(Y,{reading:s})]})})}export{V as default};
