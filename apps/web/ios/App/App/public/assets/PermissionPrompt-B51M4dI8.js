import{c as h,i as E,W as k,n as b,r as N,o as x,C as R,X as w,B as v}from"./index-BU0JQuHZ.js";import{j as i}from"./ui-vendor-BdNHRkPp.js";import{r as j}from"./react-vendor-BrWXyIWg.js";import{A as U,a as L,b as M}from"./alert-DNlM_nKM.js";import{T}from"./triangle-alert-nf4miJNe.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=h("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=h("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=h("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=h("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),_=j.forwardRef(({className:e,...a},s)=>i.jsx("textarea",{className:E("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...a}));_.displayName="Textarea";var u;(function(e){e.Prompt="PROMPT",e.Camera="CAMERA",e.Photos="PHOTOS"})(u||(u={}));var m;(function(e){e.Rear="REAR",e.Front="FRONT"})(m||(m={}));var p;(function(e){e.Uri="uri",e.Base64="base64",e.DataUrl="dataUrl"})(p||(p={}));class I extends k{async getPhoto(a){return new Promise(async(s,r)=>{if(a.webUseInput||a.source===u.Photos)this.fileInputExperience(a,s,r);else if(a.source===u.Prompt){let t=document.querySelector("pwa-action-sheet");t||(t=document.createElement("pwa-action-sheet"),document.body.appendChild(t)),t.header=a.promptLabelHeader||"Photo",t.cancelable=!1,t.options=[{title:a.promptLabelPhoto||"From Photos"},{title:a.promptLabelPicture||"Take Picture"}],t.addEventListener("onSelection",async o=>{o.detail===0?this.fileInputExperience(a,s,r):this.cameraExperience(a,s,r)})}else this.cameraExperience(a,s,r)})}async pickImages(a){return new Promise(async(s,r)=>{this.multipleFileInputExperience(s,r)})}async cameraExperience(a,s,r){if(customElements.get("pwa-camera-modal")){const t=document.createElement("pwa-camera-modal");t.facingMode=a.direction===m.Front?"user":"environment",document.body.appendChild(t);try{await t.componentOnReady(),t.addEventListener("onPhoto",async o=>{const n=o.detail;n===null?r(new b("User cancelled photos app")):n instanceof Error?r(n):s(await this._getCameraPhoto(n,a)),t.dismiss(),document.body.removeChild(t)}),t.present()}catch{this.fileInputExperience(a,s,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(a,s,r)}fileInputExperience(a,s,r){let t=document.querySelector("#_capacitor-camera-input");const o=()=>{var n;(n=t.parentNode)===null||n===void 0||n.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input",t.type="file",t.hidden=!0,document.body.appendChild(t),t.addEventListener("change",n=>{const c=t.files[0];let l="jpeg";if(c.type==="image/png"?l="png":c.type==="image/gif"&&(l="gif"),a.resultType==="dataUrl"||a.resultType==="base64"){const d=new FileReader;d.addEventListener("load",()=>{if(a.resultType==="dataUrl")s({dataUrl:d.result,format:l});else if(a.resultType==="base64"){const g=d.result.split(",")[1];s({base64String:g,format:l})}o()}),d.readAsDataURL(c)}else s({webPath:URL.createObjectURL(c),format:l}),o()}),t.addEventListener("cancel",n=>{r(new b("User cancelled photos app")),o()})),t.accept="image/*",t.capture=!0,a.source===u.Photos||a.source===u.Prompt?t.removeAttribute("capture"):a.direction===m.Front?t.capture="user":a.direction===m.Rear&&(t.capture="environment"),t.click()}multipleFileInputExperience(a,s){let r=document.querySelector("#_capacitor-camera-input-multiple");const t=()=>{var o;(o=r.parentNode)===null||o===void 0||o.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",o=>{const n=[];for(let c=0;c<r.files.length;c++){const l=r.files[c];let d="jpeg";l.type==="image/png"?d="png":l.type==="image/gif"&&(d="gif"),n.push({webPath:URL.createObjectURL(l),format:d})}a({photos:n}),t()}),r.addEventListener("cancel",o=>{s(new b("User cancelled photos app")),t()})),r.accept="image/*",r.click()}_getCameraPhoto(a,s){return new Promise((r,t)=>{const o=new FileReader,n=a.type.split("/")[1];s.resultType==="uri"?r({webPath:URL.createObjectURL(a),format:n,saved:!1}):(o.readAsDataURL(a),o.onloadend=()=>{const c=o.result;s.resultType==="dataUrl"?r({dataUrl:c,format:n,saved:!1}):r({base64String:c.split(",")[1],format:n,saved:!1})},o.onerror=c=>{t(c)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const f=N("Camera",{web:()=>new I}),y=()=>x.isNativePlatform(),O=()=>x.getPlatform(),P=async()=>{if(!y())return{status:"prompt",canRequest:!0,message:"Camera access will be requested when you take a photo"};try{const e=await f.checkPermissions();return e.camera==="granted"||e.photos==="granted"?{status:"granted",canRequest:!1}:e.camera==="denied"||e.photos==="denied"?{status:"denied",canRequest:!1,message:"Camera access denied. Please enable it in your device settings."}:{status:"prompt",canRequest:!0,message:"Camera permission needed to capture photos"}}catch(e){return console.error("Error checking camera permission:",e),{status:"unavailable",canRequest:!1,message:"Camera not available on this device"}}},q=async()=>{if(!y())return{status:"prompt",canRequest:!0,message:"Permission will be requested when camera is accessed"};try{const e=await f.requestPermissions({permissions:["camera","photos"]});return e.camera==="granted"||e.photos==="granted"?{status:"granted",canRequest:!1}:e.camera==="denied"||e.photos==="denied"?{status:"denied",canRequest:!1,message:"Camera permission denied. Please enable camera access in Settings."}:{status:e.camera,canRequest:!1,message:"Permission status: "+e.camera}}catch(e){return console.error("Error requesting camera permission:",e),{status:"denied",canRequest:!1,message:"Failed to request camera permission"}}},G=async()=>{if(!y()){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return{status:"unavailable",canRequest:!1,message:"Microphone not supported in this browser"};try{if("permissions"in navigator){const e=await navigator.permissions.query({name:"microphone"});return{status:e.state,canRequest:e.state==="prompt",message:e.state==="denied"?"Microphone access denied. Please enable it in browser settings.":void 0}}}catch{}return{status:"prompt",canRequest:!0,message:"Microphone access will be requested when you use voice features"}}return{status:"prompt",canRequest:!0,message:"Microphone permission will be requested when needed"}},X=async()=>{try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(a=>a.stop()),{status:"granted",canRequest:!1}}catch(e){if(console.error("Error requesting microphone permission:",e),e instanceof Error){if(e.name==="NotAllowedError"||e.name==="PermissionDeniedError")return{status:"denied",canRequest:!1,message:"Microphone access denied. Please enable microphone in your device settings."};if(e.name==="NotFoundError")return{status:"unavailable",canRequest:!1,message:"No microphone found on this device"}}return{status:"denied",canRequest:!1,message:"Failed to access microphone"}}},Y=async()=>{try{const e=await P();if(e.status==="denied")return{success:!1,error:e.message||"Camera access denied"};if(e.canRequest){const s=await q();if(s.status!=="granted"&&s.status!=="prompt")return{success:!1,error:s.message||"Camera permission required"}}return{success:!0,data:(await f.getPhoto({quality:90,allowEditing:!1,resultType:p.DataUrl,source:u.Camera})).dataUrl}}catch(e){return console.error("Error capturing photo:",e),e instanceof Error&&(e.message.includes("cancel")||e.message.includes("Cancel"))?{success:!1,error:"Photo capture cancelled"}:{success:!1,error:"Failed to capture photo"}}},Z=async()=>{try{const e=await P();if(e.status==="denied")return{success:!1,error:e.message||"Photo library access denied"};if(e.canRequest){const s=await q();if(s.status!=="granted"&&s.status!=="prompt")return{success:!1,error:s.message||"Photo library permission required"}}return{success:!0,data:(await f.getPhoto({quality:90,allowEditing:!1,resultType:p.DataUrl,source:u.Photos})).dataUrl}}catch(e){return console.error("Error picking photo:",e),e instanceof Error&&(e.message.includes("cancel")||e.message.includes("Cancel"))?{success:!1,error:"Photo selection cancelled"}:{success:!1,error:"Failed to select photo"}}},V=async()=>{const e=O();e==="ios"?window.open("app-settings:"):alert(e==="android"?"Please go to Settings > Apps > Vyberology > Permissions to enable camera/microphone access.":"Please check your browser settings to enable camera/microphone permissions for this site.")};function J({permissionType:e,status:a,onRequest:s,onDismiss:r,className:t="",variant:o="inline"}){const n=()=>{switch(e){case"camera":case"photos":return i.jsx(S,{className:"h-6 w-6"});case"microphone":return i.jsx(A,{className:"h-6 w-6"});default:return i.jsx(T,{className:"h-6 w-6"})}},c=()=>({camera:"Camera Permission Needed",microphone:"Microphone Permission Needed",photos:"Photo Library Permission Needed"})[e],l=()=>({camera:{granted:"Camera access granted",denied:"Camera access was denied. To use camera features, please enable camera permission in your device settings.",prompt:"This feature requires access to your camera to capture photos with frequency numbers.",limited:"Camera access is limited. Some features may not work as expected.",unavailable:"Camera is not available on this device."},microphone:{granted:"Microphone access granted",denied:"Microphone access was denied. To use voice features, please enable microphone permission in your device settings.",prompt:'This feature requires access to your microphone for voice commands like "Hey Lumen".',limited:"Microphone access is limited. Voice features may not work properly.",unavailable:"Microphone is not available on this device."},photos:{granted:"Photo library access granted",denied:"Photo library access was denied. To select photos, please enable permission in your device settings.",prompt:"This feature requires access to your photo library to select images with frequency numbers.",limited:"Photo library access is limited. You may not see all photos.",unavailable:"Photo library is not available."}})[e][a],d=()=>a==="granted"?null:a==="denied"?i.jsxs(v,{onClick:V,className:"gap-2 bg-lf-gradient hover:shadow-glow",children:[i.jsx(F,{className:"h-4 w-4"}),"Open Settings"]}):a==="prompt"&&s?i.jsxs(v,{onClick:s,className:"gap-2 bg-lf-gradient hover:shadow-glow",children:[n(),"Grant Permission"]}):null,g=()=>a==="denied"||a==="unavailable"?"destructive":"default";return o==="modal"?i.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm ${t}`,children:i.jsxs(R,{className:"relative w-full max-w-md border-white/10 bg-lf-ink/95 p-8 backdrop-blur",children:[r&&i.jsx("button",{onClick:r,className:"absolute right-4 top-4 rounded-full p-1 text-lf-slate hover:bg-white/10 hover:text-white",children:i.jsx(w,{className:"h-5 w-5"})}),i.jsxs("div",{className:"flex flex-col items-center text-center",children:[i.jsx("div",{className:`mb-4 rounded-full p-4 ${a==="denied"||a==="unavailable"?"bg-red-500/20 text-red-400":"bg-lf-violet/20 text-lf-aurora"}`,children:n()}),i.jsx("h2",{className:"mb-3 font-display text-2xl font-bold text-white",children:c()}),i.jsx("p",{className:"mb-6 text-lf-slate",children:l()}),i.jsxs("div",{className:"flex gap-3",children:[d(),r&&i.jsx(v,{onClick:r,variant:"outline",className:"border-lf-violet text-lf-violet hover:bg-lf-violet/10",children:"Cancel"})]})]})]})}):i.jsx(U,{variant:g(),className:`border-lf-violet/30 bg-lf-ink/60 backdrop-blur ${t}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`rounded-full p-2 ${a==="denied"||a==="unavailable"?"bg-red-500/20 text-red-400":"bg-lf-violet/20 text-lf-aurora"}`,children:n()}),i.jsxs("div",{className:"flex-1",children:[i.jsx(L,{className:"text-white",children:c()}),i.jsx(M,{className:"mt-2 text-lf-slate",children:l()}),d()&&i.jsx("div",{className:"mt-4",children:d()})]}),r&&i.jsx("button",{onClick:r,className:"rounded-full p-1 text-lf-slate hover:bg-white/10 hover:text-white",children:i.jsx(w,{className:"h-4 w-4"})})]})})}export{S as C,A as M,J as P,W as S,_ as T,F as a,Y as b,P as c,G as d,X as e,Z as p,q as r};
