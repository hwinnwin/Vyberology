{"version":3,"file":"AgentPanel-CaVIFGXB.js","sources":["../../src/components/ai/AgentPanel.tsx"],"sourcesContent":["/**\n * Comet-style Agent Panel\n *\n * A side panel that shows the agent's thinking process and tool executions.\n * Inspired by Comet Browser's agent interface.\n */\n\nimport { useState, useRef, useEffect } from \"react\";\nimport {\n  Bot,\n  X,\n  Play,\n  Square,\n  Trash2,\n  ChevronRight,\n  CheckCircle2,\n  XCircle,\n  Loader2,\n  Globe,\n  MousePointer,\n  FileText,\n  Link2,\n  Search,\n  ArrowRight,\n  Sparkles,\n} from \"lucide-react\";\nimport { useAgentStore, type AgentStep } from \"@/stores/agent\";\n\ninterface AgentPanelProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function AgentPanel({ isOpen, onClose }: AgentPanelProps) {\n  const [task, setTask] = useState(\"\");\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const stepsEndRef = useRef<HTMLDivElement>(null);\n\n  const { isRunning, steps, result, runTask, stop, clear } = useAgentStore();\n\n  // Auto-scroll to latest step\n  useEffect(() => {\n    stepsEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [steps]);\n\n  // Focus input when panel opens\n  useEffect(() => {\n    if (isOpen) {\n      inputRef.current?.focus();\n    }\n  }, [isOpen]);\n\n  const handleSubmit = () => {\n    if (!task.trim() || isRunning) return;\n    runTask(task.trim());\n    setTask(\"\");\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit();\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed right-0 top-0 z-50 flex h-full w-[420px] flex-col border-l border-border bg-background shadow-2xl\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between border-b border-border px-4 py-3\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-vyber-purple to-vyber-pink\">\n            <Bot className=\"h-4 w-4 text-white\" />\n          </div>\n          <div>\n            <h2 className=\"text-sm font-semibold\">VybeR Agent</h2>\n            <p className=\"text-xs text-muted-foreground\">\n              {isRunning ? \"Working...\" : \"Ready\"}\n            </p>\n          </div>\n        </div>\n        <div className=\"flex items-center gap-1\">\n          {steps.length > 0 && (\n            <button\n              onClick={clear}\n              className=\"rounded-lg p-2 text-muted-foreground hover:bg-secondary hover:text-foreground\"\n              title=\"Clear history\"\n            >\n              <Trash2 className=\"h-4 w-4\" />\n            </button>\n          )}\n          <button\n            onClick={onClose}\n            className=\"rounded-lg p-2 text-muted-foreground hover:bg-secondary hover:text-foreground\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Steps List */}\n      <div className=\"flex-1 overflow-y-auto p-4\">\n        {steps.length === 0 && !isRunning ? (\n          <div className=\"flex h-full flex-col items-center justify-center text-center\">\n            <div className=\"mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-vyber-purple/20 to-vyber-pink/20\">\n              <Sparkles className=\"h-8 w-8 text-vyber-purple\" />\n            </div>\n            <h3 className=\"mb-2 font-medium\">What can I help you with?</h3>\n            <p className=\"mb-6 max-w-xs text-sm text-muted-foreground\">\n              I can browse the web, search for information, fill forms, and complete tasks for you.\n            </p>\n            <div className=\"space-y-2\">\n              {[\n                \"Search for flights to Tokyo next week\",\n                \"Find the latest news about AI\",\n                \"Look up the weather in San Francisco\",\n              ].map((suggestion) => (\n                <button\n                  key={suggestion}\n                  onClick={() => setTask(suggestion)}\n                  className=\"block w-full rounded-lg border border-border bg-secondary/30 px-3 py-2 text-left text-sm transition-colors hover:border-vyber-purple/50 hover:bg-secondary\"\n                >\n                  {suggestion}\n                </button>\n              ))}\n            </div>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {steps.map((step, index) => (\n              <StepCard key={index} step={step} />\n            ))}\n            {isRunning && (\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\n                <span>Thinking...</span>\n              </div>\n            )}\n            <div ref={stepsEndRef} />\n          </div>\n        )}\n\n        {/* Result */}\n        {result && !isRunning && (\n          <div\n            className={`mt-4 rounded-lg border p-4 ${\n              result.success\n                ? \"border-green-500/30 bg-green-500/10\"\n                : \"border-red-500/30 bg-red-500/10\"\n            }`}\n          >\n            <div className=\"mb-2 flex items-center gap-2\">\n              {result.success ? (\n                <CheckCircle2 className=\"h-5 w-5 text-green-500\" />\n              ) : (\n                <XCircle className=\"h-5 w-5 text-red-500\" />\n              )}\n              <span className=\"font-medium\">\n                {result.success ? \"Task Complete\" : \"Task Failed\"}\n              </span>\n            </div>\n            <p className=\"text-sm text-muted-foreground\">\n              {result.summary || result.error}\n            </p>\n            {result.data !== undefined && result.data !== null && (\n              <pre className=\"mt-2 max-h-32 overflow-auto rounded bg-secondary/50 p-2 text-xs\">\n                {JSON.stringify(result.data as object, null, 2)}\n              </pre>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Input Area */}\n      <div className=\"border-t border-border p-4\">\n        <div className=\"relative\">\n          <textarea\n            ref={inputRef}\n            value={task}\n            onChange={(e) => setTask(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Tell me what to do...\"\n            rows={2}\n            disabled={isRunning}\n            className=\"w-full resize-none rounded-lg border border-border bg-secondary/30 px-4 py-3 pr-12 text-sm placeholder:text-muted-foreground focus:border-vyber-purple focus:outline-none focus:ring-2 focus:ring-vyber-purple/20 disabled:opacity-50\"\n          />\n          <button\n            onClick={isRunning ? stop : handleSubmit}\n            disabled={!task.trim() && !isRunning}\n            className={`absolute bottom-3 right-3 rounded-lg p-2 transition-colors ${\n              isRunning\n                ? \"bg-red-500 text-white hover:bg-red-600\"\n                : \"bg-gradient-to-r from-vyber-purple to-vyber-pink text-white hover:opacity-90 disabled:opacity-50\"\n            }`}\n          >\n            {isRunning ? (\n              <Square className=\"h-4 w-4\" />\n            ) : (\n              <Play className=\"h-4 w-4\" />\n            )}\n          </button>\n        </div>\n        <p className=\"mt-2 text-center text-xs text-muted-foreground\">\n          Press Enter to run â€¢ Shift+Enter for new line\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction StepCard({ step }: { step: AgentStep }) {\n  const [expanded, setExpanded] = useState(false);\n\n  const getIcon = () => {\n    switch (step.type) {\n      case \"thinking\":\n        return <Bot className=\"h-4 w-4 text-vyber-purple\" />;\n      case \"tool_call\":\n        return getToolIcon(step.tool);\n      case \"tool_result\":\n        return step.result?.success ? (\n          <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\n        ) : (\n          <XCircle className=\"h-4 w-4 text-red-500\" />\n        );\n      case \"complete\":\n        return <CheckCircle2 className=\"h-4 w-4 text-green-500\" />;\n      case \"error\":\n        return <XCircle className=\"h-4 w-4 text-red-500\" />;\n      default:\n        return <ChevronRight className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getToolIcon = (tool?: string) => {\n    switch (tool) {\n      case \"navigate\":\n      case \"search_google\":\n        return <Globe className=\"h-4 w-4 text-blue-500\" />;\n      case \"click\":\n        return <MousePointer className=\"h-4 w-4 text-orange-500\" />;\n      case \"extract_text\":\n        return <FileText className=\"h-4 w-4 text-green-500\" />;\n      case \"extract_links\":\n        return <Link2 className=\"h-4 w-4 text-cyan-500\" />;\n      case \"fill_form\":\n        return <ArrowRight className=\"h-4 w-4 text-purple-500\" />;\n      default:\n        return <Search className=\"h-4 w-4 text-yellow-500\" />;\n    }\n  };\n\n  const getTitle = () => {\n    switch (step.type) {\n      case \"thinking\":\n        return \"Thinking\";\n      case \"tool_call\":\n        return `Using ${step.tool}`;\n      case \"tool_result\":\n        return `${step.tool} ${step.result?.success ? \"succeeded\" : \"failed\"}`;\n      case \"complete\":\n        return \"Complete\";\n      case \"error\":\n        return \"Error\";\n      default:\n        return \"Step\";\n    }\n  };\n\n  return (\n    <div className=\"rounded-lg border border-border bg-secondary/20 overflow-hidden\">\n      <button\n        onClick={() => setExpanded(!expanded)}\n        className=\"flex w-full items-center gap-3 p-3 text-left hover:bg-secondary/30\"\n      >\n        <div className=\"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-secondary\">\n          {getIcon()}\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <p className=\"text-sm font-medium\">{getTitle()}</p>\n          <p className=\"truncate text-xs text-muted-foreground\">\n            {step.content.slice(0, 60)}\n            {step.content.length > 60 ? \"...\" : \"\"}\n          </p>\n        </div>\n        <ChevronRight\n          className={`h-4 w-4 text-muted-foreground transition-transform ${\n            expanded ? \"rotate-90\" : \"\"\n          }`}\n        />\n      </button>\n      {expanded && (\n        <div className=\"border-t border-border bg-secondary/10 p-3\">\n          <p className=\"mb-2 text-sm whitespace-pre-wrap\">{step.content}</p>\n          {step.input !== undefined && step.input !== null && (\n            <div className=\"mt-2\">\n              <p className=\"text-xs font-medium text-muted-foreground\">Input:</p>\n              <pre className=\"mt-1 rounded bg-secondary/50 p-2 text-xs overflow-auto max-h-24\">\n                {JSON.stringify(step.input as object, null, 2)}\n              </pre>\n            </div>\n          )}\n          {step.result && (\n            <div className=\"mt-2\">\n              <p className=\"text-xs font-medium text-muted-foreground\">Result:</p>\n              <pre className=\"mt-1 rounded bg-secondary/50 p-2 text-xs overflow-auto max-h-24\">\n                {JSON.stringify(step.result, null, 2)}\n              </pre>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default AgentPanel;\n"],"names":["AgentPanel","isOpen","onClose","task","setTask","useState","inputRef","useRef","stepsEndRef","isRunning","steps","result","runTask","stop","clear","useAgentStore","useEffect","handleSubmit","handleKeyDown","e","jsxs","jsx","Bot","Trash2","X","Sparkles","suggestion","step","index","StepCard","Loader2","CheckCircle2","XCircle","Square","Play","expanded","setExpanded","getIcon","getToolIcon","ChevronRight","tool","Globe","MousePointer","FileText","Link2","ArrowRight","Search","getTitle"],"mappings":"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"}